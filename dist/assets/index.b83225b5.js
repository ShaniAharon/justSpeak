var F=Object.defineProperty;var I=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var L=(e,t,s)=>t in e?F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,v=(e,t)=>{for(var s in t||(t={}))N.call(t,s)&&L(e,s,t[s]);if(I)for(var s of I(t))O.call(t,s)&&L(e,s,t[s]);return e};import{o as l,c as d,a as n,b as m,r as y,d as E,t as u,F as V,e as j,f as B,i as q,U as H,D as K,K as P,n as J,X as W,W as X,g as z,x as $,h as Y,T as Z,A as G,E as Q,w as f,v as b,j as tt,k as et,l as T,m as st,p as ot,q as at,s as nt}from"./vendor.8adb6f3c.js";const rt=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}};rt();var p=(e,t)=>{const s=e.__vccOpts||e;for(const[i,a]of t)s[i]=a;return s};const it={name:"AppHeader",components:{},data(){return{}},created(){},methods:{goHome(){console.log("run"),this.$router.push("/")}},computed:{},unmounted(){}},ct={class:"main-header flex"},lt={class:"flex justify-between main-layout-container"},dt=n("span",{class:"clr-teal"},"just",-1),ut=m("Speak "),pt=[dt,ut];function mt(e,t,s,i,a,o){return l(),d("header",ct,[n("div",lt,[n("h1",{onClick:t[0]||(t[0]=(...r)=>o.goHome&&o.goHome(...r)),class:"logo"},pt)])])}var kt=p(it,[["render",mt]]);const ht={created(){this.$store.dispatch({type:"loadTasks"})},components:{appHeader:kt}},ft={id:"app"};function _t(e,t,s,i,a,o){const r=y("app-header"),c=y("router-view");return l(),d("div",ft,[E(r),E(c)])}var yt=p(ht,[["render",_t]]);const gt={name:"TaskPreview",props:["task"],emits:["remove","detail"],components:{},data(){return{}},created(){},methods:{removeTask(){this.$emit("remove",this.task._id)},showDetails(){this.$emit("detail",this.task._id)},editTask(){this.$router.push(`/task/edit/${this.task._id}`)}},computed:{formatPrice(){return(this.task.price+"").slice(0,1)},formatTime(){return new Date(+this.task.createdAt).toLocaleString()}},unmounted(){}},vt={class:"task flex flex-col gap-1 p-3"},bt={class:"task__txt clr-teal uppercase"},Tt=n("span",{class:"fw-bold"},"Created At: ",-1),wt={class:"btn-group actions"};function xt(e,t,s,i,a,o){return l(),d("article",vt,[n("h3",bt,u(s.task.title),1),n("p",null,[Tt,m(" "+u(o.formatTime),1)]),n("div",wt,[n("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...r)=>o.showDetails&&o.showDetails(...r))},"details"),n("button",{class:"btn btn-info",onClick:t[1]||(t[1]=(...r)=>o.editTask&&o.editTask(...r))},"edit"),n("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...r)=>o.removeTask&&o.removeTask(...r))},"delete")])])}var Et=p(gt,[["render",xt]]);const $t={name:"TaskList",props:["tasks"],emits:["removed","details"],components:{taskPreview:Et},data(){return{}},created(){},methods:{removeTask(e){this.$emit("removed",e)},taskDetails(e){this.$emit("details",e)}},computed:{},unmounted(){}},Rt={class:"flex task-list items-start gap-2"};function It(e,t,s,i,a,o){const r=y("task-preview");return l(),d("main",Rt,[(l(!0),d(V,null,j(s.tasks,c=>(l(),B(r,{key:c._id,task:c,onRemove:o.removeTask,onDetail:o.taskDetails},null,8,["task","onRemove","onDetail"]))),128))])}var Lt=p($t,[["render",It]]);const w={queryData:Ct,getEntityById:At,saveEntity:Ut,removeEntity:Mt},Bt={apiKey:"AIzaSyANKZXygD24jjRHm-yYau7Ia7vMVTCWjb8",authDomain:"tasks-e7a14.firebaseapp.com",projectId:"tasks-e7a14",storageBucket:"tasks-e7a14.appspot.com",messagingSenderId:"767080706489",appId:"1:767080706489:web:8582553f201eb28a07c668"},St=q(Bt),Dt=H(St),h=K(Dt,"task");async function Ct(e){let t=h;if(e!=null&&e.txt){const s=e.txt.toLowerCase();t=P(h,X("title"),W(s),J(s+"\uF8FF"))}try{const s=await z(t);return console.log("tasksSnapshot",s),s.docs.map(i=>v({_id:i.id},i.data()))}catch(s){console.error("Error geting documents: ",s)}}async function At(e){const t=$(h,e);try{const s=await Y(t);if(s.exists())return v({_id:e},s.data());console.log("No such document!")}catch(s){console.error("Error finding document: ",s)}}async function Ut(e){if(e._id){const t=JSON.parse(JSON.stringify(e)),s=$(h,e._id);delete t._id;try{return await Z(s,t),e}catch(i){console.error("Error updating document: ",i)}}else try{const t=await G(h,e);return v({_id:t.id},e)}catch(t){console.error("Error saving document: ",t)}}async function Mt(e){try{await Q($(h,e))}catch(t){console.error("Error deleting document: ",t)}}const _={query:Ft,getById:Nt,save:Ot,remove:Vt,getEmptyTask:jt};async function Ft(e={}){return w.queryData(e)}async function Nt(e){return w.getEntityById(e)}async function Ot(e){return w.saveEntity(e)}async function Vt(e){return w.removeEntity(e)}function jt(){return{title:"",description:"",importance:1,createdAt:Date.now()+"",doneAt:null,status:"",audioSrc:""}}const qt={name:"TaskEdit",components:{},data(){return{taskToEdit:null,mediaRecorder:null,chunks:null}},async created(){const e=this.taskId;if(e){const t=await this.$store.dispatch({type:"getTaskById",taskId:e});this.taskToEdit=t}else this.taskToEdit=_.getEmptyTask();this.chunks=[],this.createMedia()},methods:{async save(){await this.$store.dispatch({type:"saveTask",task:this.taskToEdit}),this.$router.push("/")},goBack(){this.$router.push("/")},createMedia(){const e={audio:!0};navigator.mediaDevices.getUserMedia(e).then(this.onSuccess,this.onError)},onSuccess(e){this.mediaRecorder=new MediaRecorder(e),this.mediaRecorder.onstop=t=>{console.log("data available after MediaRecorder.stop() called.");const s=prompt("Enter a name for your sound clip?","My unnamed clip"),i=document.createElement("article"),a=document.createElement("p"),o=document.createElement("audio"),r=document.createElement("button");i.classList.add("clip"),o.controls=!0,r.textContent="Delete",r.className="delete",s===null?a.textContent="My unnamed clip":a.textContent=s,i.appendChild(o),i.appendChild(a),i.appendChild(r),this.$refs.soundClips.appendChild(i);async function c(k){return new Promise((A,U)=>{let x=new FileReader;x.onerror=U,x.onload=M=>A(M.target.result),x.readAsDataURL(k)})}const g=new Blob(this.chunks,{type:"audio/ogg; codecs=opus"});c(g).then(k=>{console.log(k),this.taskToEdit.audioSrc=k}),this.chunks=[];const C=window.URL.createObjectURL(g);o.src=C,console.log("recorder stopped"),r.onclick=function(k){k.target.closest(".clip").remove()}},this.mediaRecorder.ondataavailable=t=>{console.log("this.chunks",this.chunks),this.chunks.push(t.data)}},onRecord(){!this.mediaRecorder||(this.mediaRecorder.start(),console.log(this.mediaRecorder.state),console.log("recorder started"),console.log("document",document))},onStop(){!this.mediaRecorder||(this.mediaRecorder.stop(),console.log(this.mediaRecorder.state),console.log("recorder stopped"))},onError(e){console.log("The following error occured: "+e)}},computed:{formTitle(){return this.taskId?"Edit task":"Add task"},taskId(){return this.$route.params.taskId}},unmounted(){}},Ht={key:0,class:"task-edit"},Kt={class:"form-control"},Pt=n("label",{for:"title",class:"form-label"}," Title ",-1),Jt={class:"form-control"},Wt=n("label",{for:"description",class:"form-label"}," Description ",-1),Xt={class:"form-control"},zt=n("label",{for:"importance",class:"form-label"}," Importance ",-1),Yt={class:"form-control"},Zt=n("label",{for:"status",class:"form-label"}," Status ",-1),Gt=n("option",null,"open",-1),Qt=n("option",null,"in progress",-1),te=n("option",null,"done",-1),ee=[Gt,Qt,te],se={ref:"soundClips",class:"sound-clips"},oe={class:"btn-group"};function ae(e,t,s,i,a,o){return a.taskToEdit?(l(),d("section",Ht,[n("h1",null,u(a.taskToEdit._id?"Edit":"Add")+" Task",1),n("div",null,[n("div",Kt,[Pt,f(n("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>a.taskToEdit.title=r),id:"title",class:"form-input",type:"text"},null,512),[[b,a.taskToEdit.title]])]),n("div",Jt,[Wt,f(n("textarea",{"onUpdate:modelValue":t[1]||(t[1]=r=>a.taskToEdit.description=r),class:"form-input",type:"text",id:"description"},null,512),[[b,a.taskToEdit.description]])]),n("div",Xt,[zt,f(n("input",{max:"3",min:"1","onUpdate:modelValue":t[2]||(t[2]=r=>a.taskToEdit.importance=r),class:"form-input",type:"number",id:"importance"},null,512),[[b,a.taskToEdit.importance]])]),n("div",Yt,[Zt,f(n("select",{id:"status",name:"status","onUpdate:modelValue":t[3]||(t[3]=r=>a.taskToEdit.status=r),class:"form-input"},ee,512),[[tt,a.taskToEdit.status]])]),n("section",se,null,512)]),n("div",oe,[n("button",{onClick:t[4]||(t[4]=(...r)=>o.save&&o.save(...r)),class:"btn btn-success"},"save"),n("button",{onClick:t[5]||(t[5]=(...r)=>o.goBack&&o.goBack(...r)),class:"btn btn-danger"},"back"),n("button",{onClick:t[6]||(t[6]=(...r)=>o.onRecord&&o.onRecord(...r)),class:"btn btn-warning"},"Record"),n("button",{onClick:t[7]||(t[7]=et((...r)=>o.onStop&&o.onStop(...r),["stop"])),class:"btn btn-danger"},"Stop")])])):T("",!0)}var S=p(qt,[["render",ae]]);const ne={name:"TaskDetails",components:{},data(){return{task:null,audioURL:null}},created(){this.loadTask()},methods:{async loadTask(){var i;const e=await this.$store.dispatch({type:"getTaskById",taskId:this.taskId});if(this.task=e,!((i=this.task)!=null&&i.audioSrc))return;const t=this.convertDataURIToBinary(this.task.audioSrc);console.log("binary",t);const s=new Blob([t],{type:"audio/ogg; codecs=opus"});this.audioURL=window.URL.createObjectURL(s)},convertDataURIToBinary(e){var t=";base64,",s=e.indexOf(t)+t.length,i=e.substring(s),a=window.atob(i),o=a.length,r=new Uint8Array(new ArrayBuffer(o));for(let c=0;c<o;c++)r[c]=a.charCodeAt(c);return r},goBack(){this.$router.push("/")}},computed:{taskId(){return this.$route.params.taskId}},unmounted(){}},re={key:0,class:"task-details gap-2"},ie=n("h1",null,"Todo Details",-1),ce={class:"inner-txt flex-col"},le=n("span",{class:"fw-bold clr-teal uppercase"},"id: ",-1),de=n("span",{class:"fw-bold clr-teal uppercase"},"title: ",-1),ue=n("span",{class:"fw-bold clr-teal uppercase"},"Description: ",-1),pe=n("span",{class:"fw-bold clr-teal uppercase"},"importance: ",-1),me=n("span",{class:"fw-bold clr-teal uppercase"},"Status: ",-1),ke=["src"];function he(e,t,s,i,a,o){return a.task?(l(),d("section",re,[ie,n("div",ce,[n("p",null,[le,m(" "+u(a.task._id),1)]),n("p",null,[de,m(" "+u(a.task.title),1)]),n("p",null,[ue,m(" "+u(a.task.description),1)]),n("p",null,[pe,m(" "+u(a.task.importance),1)]),n("p",null,[me,m(" "+u(a.task.status),1)]),a.audioURL?(l(),d("audio",{key:0,controls:"",src:a.audioURL},null,8,ke)):T("",!0)]),n("button",{onClick:t[0]||(t[0]=(...r)=>o.goBack&&o.goBack(...r)),class:"btn btn-warning"},"go back")])):T("",!0)}var D=p(ne,[["render",he]]);function fe(e=5){var t="",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let i=0;i<e;i++)t+=s.charAt(Math.floor(Math.random()*s.length));return t}function _e(e,t=300){let s;return(...i)=>{clearTimeout(s),s=setTimeout(()=>{e.apply(this,i)},t)}}function ye(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}const ge={makeId:fe,getRandomInt:ye,debounce:_e},ve={name:"task-filter",emits:["filtered"],data(){return{filterBy:{txt:""}}},created(){var e;this.filterBy.txt=((e=this.$store.getters.filterBy)==null?void 0:e.txt)||"",this.setFilter=ge.debounce(this.setFilter,400)},mounted(){this.$refs.searchInput.focus()},methods:{setFilter(){this.$emit("filtered",JSON.parse(JSON.stringify(this.filterBy)))}}},be={class:"filter-container flex align-center"},Te={class:"search task-filter flex align-center g-1"};function we(e,t,s,i,a,o){return l(),d("section",be,[n("div",Te,[f(n("input",{type:"text",class:"input-search",ref:"searchInput","onUpdate:modelValue":t[0]||(t[0]=r=>a.filterBy.txt=r),placeholder:"Search ",onInput:t[1]||(t[1]=(...r)=>o.setFilter&&o.setFilter(...r))},null,544),[[b,a.filterBy.txt]])])])}var xe=p(ve,[["render",we]]),Ee="/firebase-vue/assets/whale.2fb17326.gif";const $e={name:"TaskApp",components:{taskList:Lt,taskEdit:S,taskFilter:xe,taskDetails:D},data(){return{}},methods:{removeTask(e){this.$store.dispatch({type:"removeTask",id:e})},addTask(){this.$router.push("/task/edit")},showDetails(e){this.$router.push(`/task/${e}`)},setFilter(e){this.$store.dispatch({type:"filter",filterBy:e})}},computed:{tasks(){return this.$store.getters.tasks},isLoading(){return this.$store.getters.isLoading}},unmounted(){}},Re={key:0,class:"main-layout-container flex-col"},Ie={class:"flex action-container space-between"},Le={key:1,class:"loading"},Be=n("img",{src:Ee,alt:""},null,-1),Se=[Be];function De(e,t,s,i,a,o){const r=y("task-filter"),c=y("task-list");return o.isLoading?(l(),d("div",Le,Se)):(l(),d("main",Re,[n("section",Ie,[E(r,{onFiltered:o.setFilter},null,8,["onFiltered"]),n("button",{onClick:t[0]||(t[0]=(...g)=>o.addTask&&o.addTask(...g)),class:"add-btn btn btn-warning"},"Add Task")]),o.tasks?(l(),B(c,{key:0,onRemoved:o.removeTask,onDetails:o.showDetails,tasks:o.tasks},null,8,["onRemoved","onDetails","tasks"])):T("",!0)]))}var Ce=p($e,[["render",De]]);const Ae=st({history:ot("/firebase-vue/"),routes:[{path:"/",name:"home",component:Ce},{path:"/task/edit/:taskId?",component:S},{path:"/task/:taskId",component:D}]});var Ue={state:{tasks:null,filterBy:null,isLoading:!1},getters:{tasks(e){return e.tasks},isLoading(e){return e.isLoading},filterBy(e){return e.filterBy}},mutations:{setTasks(e,{tasks:t}){e.tasks=t},setIsLoading(e,{isLoading:t}){e.isLoading=t},removeTask(e,{id:t}){const s=e.tasks.findIndex(i=>i._id===t);e.tasks.splice(s,1)},saveTask(e,{task:t}){const s=e.tasks.findIndex(i=>i._id===t._id);s!==-1?e.tasks.splice(s,1,t):e.tasks.unshift(t)},setFilter(e,{filterBy:t}){e.filterBy=t}},actions:{async loadTasks({commit:e,state:t}){e({type:"setIsLoading",isLoading:!0});try{var s=await _.query(t.filterBy);e({type:"setTasks",tasks:s})}catch(i){throw console.error("Cannot Load tasks",i),i}finally{setTimeout(()=>{e({type:"setIsLoading",isLoading:!1})},500)}},async saveTask({commit:e},{task:t}){try{const s=await _.save(t);e({type:"saveTask",task:s})}catch(s){throw console.error("Cannot save task",s),s}},async removeTask({commit:e},{id:t}){try{await _.remove(t),e({type:"removeTask",id:t})}catch(s){throw console.error("Cannot remove task",s),s}},async getTaskById(e,{taskId:t}){try{return await _.getById(t)}catch(s){console.log(s)}},async filter({commit:e,dispatch:t},{filterBy:s}){e({type:"setFilter",filterBy:s}),await t({type:"loadTasks"})}}};const Me=at({strict:!0,modules:{taskStore:Ue}});const R=nt(yt);R.use(Ae);R.use(Me);R.mount("#app");
